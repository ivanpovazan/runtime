<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <OutputType>Exe</OutputType>
    <TargetFramework>net8.0</TargetFramework>
    <TargetName>HelloMint</TargetName>
    <DefineConstants Condition="'$(DumpIlBytes)' == 'true'">$(DefineConstants);DUMP_IL_BYTES</DefineConstants>
  </PropertyGroup>

  <PropertyGroup>
    <IlcPath>$(RuntimeBinDir)/ilc-published/</IlcPath>
    <IlcSdkPath>$(RuntimeBinDir)/aotsdk/</IlcSdkPath>
    <IlcToolsPath>$(IlcPath)</IlcToolsPath>
    <IlcBuildTasksPath>$(IlcToolsPath)/netstandard/ILCompiler.Build.Tasks.dll</IlcBuildTasksPath>
    <IlcFrameworkPath>$(LibrariesAllBinArtifactsPath)</IlcFrameworkPath>
    <IlcFrameworkNativePath>$(LibrariesAllBinArtifactsPath)</IlcFrameworkNativePath>
    <IlcCompileDependsOn>Compile;ComputeIlcCompileInputs;SetupOSSpecificProps;PrepareForILLink</IlcCompileDependsOn>
  </PropertyGroup>

  <ItemGroup>
    <RdXmlFile Condition="'$(DumpIlBytes)' == 'true'" Include="rd.xml" />
  </ItemGroup>

  <Import Project="$(RuntimeBinDir)/build/Microsoft.DotNet.ILCompiler.SingleEntry.targets" />

  <Target Name="_ConfigureIlcFrameworkPaths" BeforeTargets="SetupProperties">
    <PropertyGroup>
      <IlcFrameworkPath>$(LibrariesAllBinArtifactsPath)</IlcFrameworkPath>
      <IlcFrameworkNativePath>$(LibrariesAllBinArtifactsPath)</IlcFrameworkNativePath>
    </PropertyGroup>
  </Target>

  <Target Name="PrintRspFileLocation" AfterTargets="Publish">
    <Message Text="ILC rsp file is generated at: %(ManagedBinary.IlcRspFile)" Importance="High" />
  </Target>
</Project>